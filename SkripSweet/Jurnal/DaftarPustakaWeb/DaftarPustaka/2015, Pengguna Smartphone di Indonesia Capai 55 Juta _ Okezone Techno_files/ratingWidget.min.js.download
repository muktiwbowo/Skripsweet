!function(i){i.fn.ratingWidget=function(e){function n(i){var e=["news","economy","lifestyle","celebrity","bola","sports","techno"],n=i.split("."),a=n[0],a=a.split("//");return-1==e.indexOf(a[1])?"default":a[1]}function a(i){return""==i?-1:"foto"==i?2:"video"==i?3:1}function r(){i("input[name='rating_id']").prop("disabled",!0),i(".control-group").removeClass("able"),i(".control-group").addClass("unable")}function t(){i(".control-group").removeClass("unable"),i(".control-group").addClass("able")}function l(){var e=JSON.parse(localStorage.getItem("okezone_rate_article"));if(null!=e)for(var n in e){if(parseInt(e[n].article_id)==parseInt(u.article_id)){i(g).find(".respond").addClass("thanks"),i(g).find(".respond").html("menurut anda artikel ini: <span>"+c[e[n].rating_id]+"</span>"),o(e[n].rating_id),r();break}t()}else t()}function o(e){i(".radioRating").find("div[rating_id='"+e+"']").addClass("checked")}function d(){i.ajax({type:"GET",url:v.fetch+"/"+u.article_id+"/"+u.content_type,success:function(e){for(var n=i(".radioRating").find("input[name='rating_id']"),a=0;a<n.length;a++){var r=n[a].value;if(null==e.result[r].count)t=0,l=0;else var t=e.result[r].round,l=e.result[r].count;i(".radioRating").find("div[rating_id='"+r+"']").find(".info").find(".lbl").html(t+" %")}},error:function(e){i(g).html("")}})}var s="http://emoji.okezone.com";"http:"!=location.protocol&&(s="https://emoji.okezone.com");var c={1:"Menarik",2:"Inspiratif",3:"So - So",4:"Menyedihkan",5:"Meresahkan"},u=i.extend({self:this,main_label:"Apa pendapat anda mengenai artikel ini?",url:null,browser:null,ip_address:null,user_id:null,unique_id:null,server_address:s,img_address:"https://cdn.okezone.com/underwood/img/emoji"},e);u.content_type=a(u.url.split(".").shift().split("http://")[1]);var p=u,v=i.extend({fetch:u.server_address+"/rating/fetch",insert:u.server_address+"/rating/insert"}),f=i(this),g=f.selector,_='<label class="main-label">'+u.main_label+"</label>";_+="<div class='row radioRating'>";var m=n(u.url);for(var h in c){var b='<div class="rad ratingicon"  title="'+c[h]+'" rating_id="'+h+'">';b+='<div class="control-group">',b+="<label>",b+='<div class="radio">',b+='<input type="radio" value="'+h+'" name="rating_id" >',b+='<img src="'+u.img_address+"/"+m+"/"+h+'.png"/>',b+="</div>",b+='<div class="info rid_'+h+'">',b+='<div class="row">',b+='<div class="lbl"></div>',b+='<div class="round"></div>',b+="</div>",b+="</div>",b+="</label>",b+='<div class="clear"></div>',b+="</div>",b+="</div>",_+=b}_+="</div>",_+="<div class='respond'></div>",g="#rating-container",i(g).html(_),i(".radioRating input[name='rating_id']").change(function(e){i.ajax({type:"POST",url:v.insert,data:{url:p.url,ip_address:p.ip_address,browser:p.browser,article_id:p.article_id,channel_id:p.channel_id,cookie:p.unique_id,content_type:p.content_type,rating_id:i("input[name=rating_id]:checked").val()},success:function(i){var e=JSON.parse(localStorage.getItem("okezone_rate_article"));if(null!=e)var n=Object.assign(e,i.obj);else var n=i.obj;localStorage.setItem("okezone_rate_article",JSON.stringify(n)),d(),l()},error:function(e){i(g).html("")}})}).ready(function(){d(),l()})}}(jQuery);